{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}{% endblock %}</title>
    {% block head %}{% endblock %}
    <script src="https://kit.fontawesome.com/f0d3ee0f06.js" crossorigin="anonymous"></script>
    <script src="{% static 'base/scripts/main.js' %}"></script>
    <script src="{% static 'base/scripts/notifications.js' %}"></script>
    <link href="{% static 'base/styles/main.css' %}" rel="stylesheet">
    <link href="{% static 'base/styles/index.css' %}" rel="stylesheet">


</head>
<body>

    <!-- Navbar -->
    <nav class="navbar" id="menu">
        <div class="navbar-nav" id="logo">

            <a href="{% url 'base:index' %}" class="nav-link">Final Project</a>

            
        </div>

        <div class="navbar-nav" id="search">
            <form>
                <input type="text" name="search_query" id="search-input">
            </form>
        </div>

        <div class="navbar-nav double">

            <ul class="navbar-list">
            {% if not request.user.is_authenticated %}


            <!-- Login -->
            <li class="nav-item" id="sign-in">
                <a href="{% url 'users:login' %}" class="nav-link">Log In</a>
            </li>
        
            <!-- Register -->
            <li class="nav-item" id="sign-up">
                <a href="{% url 'users:register' %}" class="nav-link">Sign Up</a>
            </li>

            {% else %}


            <!-- Notifications -->
            <li class="drop nav-item">
                <div class="drop icon">
                    <i class="drop fas fa-bell" id="bell">
                        {% if request.user.notifications.all %}
                            <span class="notifi-number"></span>
                        {% endif %}
                    </i>

                    
                </div>
                <div class="drop dropdown" id="box">
                    <h2 class="drop drop-t">Notifications</h2>
                    {% for notification in request.user.sorted_notifications %}
                        <div class="drop drop-item">

                            {% if not notification.read %}
                                <div class="drop circle"></div>
                            {% endif %}
                            <div class="drop text">

                                <h4 class="drop drop-title">{{ notification.origin }}</h4>
                                <p class="drop drop-text">{{ notification.text }}</p>
                                <p class="drop drop-timestamp">{{ notification.time }}</p>
                                <div class="drop reply-btn-container">
                                    <button class="drop accept notifi-reply-btn" data-url="{{ notification.url }}" data-val="accept">Accept</button>
                                    <button class="drop deny notifi-reply-btn" data-url="{{ notification.url }}" data-val="deny">Deny</button>
                                </div>
                            </div>
                        </div>

                    {% endfor %}
                </div>
            </li>
                        
            <li class="drop nav-item">
                <div class="drop icon">
                    <div class="drop image-cropper">

                        <img src="{{ request.user.picture.url }}" width="50px" height="50px" class="drop drop-pic">
                    </div>
                </div>

                <div class="drop dropdown">
                    <h2 class="drop drop-t">Signed in as <strong>{{ request.user.first_name }} {{ request.user.last_name }}</strong></h2>
                    
                    <!-- Medical Info -->
                    <div class="drop drop-item">
                        <div class="drop text">
                            <a class="drop drop-link" href="{% url 'patients:profile' request.user.name %}">
                                <i class="drop fas fa-clipboard"></i>
                                <p class="drop drop-text">Medical Info</p>

                            </a>
                            
                        </div>
                    </div>

                    

                    <!-- Logout -->
                    <div class="drop drop-item">
                        <div class="drop text">
                            <a class="drop drop-link" href="{% url 'users:logout' %}">
                                <i class="drop fas fa-sign-out-alt"></i>
                                <p class="drop drop-text">Logout</p>
                            </a>
                        </div>
                    </div>



                    
                </div>

            </li>


            </ul>


            {% endif %}

        </div>
        
    </nav>
    {% if request.user.is_authenticated %}
        {% include 'base/sidebar.html' %}
    {% endif %}

    <!-- Body -->
    <main id="main">
        {% block body %}
        {% endblock %}
    </main>

    
</body>
</html>
